"use strict";(self["webpackChunkofs_2_0"]=self["webpackChunkofs_2_0"]||[]).push([[757],{1757:(e,t,s)=>{s.r(t),s.d(t,{default:()=>fe});var l=s(3673),a=s(2323);const i={class:"q-pa-md",style:{overflow:"auto","max-height":"90vh","min-height":"90vh"},container:""},r={class:"q-pa-md row",style:{"margin-left":"15px","margin-right":"15px","padding-left":"0px","border-bottom":"2px solid #DEDEDE"}},o=(0,l._)("div",{class:"col-6"},[(0,l._)("div",{style:{"font-size":"20px"}},[(0,l._)("b",null,"Delivery Performance")])],-1),c={class:"col-6"},d={style:{"font-size":"15px","text-align":"right"}},n=(0,l._)("b",null,"Date: ",-1),m=(0,l._)("div",{style:{"margin-left":"15px","margin-top":"15px","font-size":"15px"}},[(0,l._)("b",null,"Filters:")],-1),h={class:"items-start q-pa-md row"},p={class:"col-sm-2 col-xs-6 q-pa-sm"},u={class:"col-sm-2 col-xs-6 q-pa-sm"},_={class:"col-sm-2 col-xs-6 q-pa-sm"},v={class:"col-sm-2 col-xs-6 q-pa-sm"},x={class:"col-sm-2 col-xs-6 q-pa-sm"},g={class:"row"},y={class:"col-12 col-md-3",style:{padding:"5px"}},f=(0,l._)("div",{class:"text-h6"},"Gross Total ",-1),w={class:"text-subtitle2 center"},b={class:"col-12 col-md-3",style:{padding:"5px"}},D=(0,l._)("div",{class:"text-h6"},"Net Total",-1),P={class:"text-subtitle2 center"},T={class:"col-12 col-md-3",style:{padding:"5px"}},S=(0,l._)("div",{class:"text-h6"},"Average Check",-1),C={class:"text-subtitle2 center"},R={class:"col-12 col-md-3",style:{padding:"5px"}},q=(0,l._)("div",{class:"text-h6"},"Cancel TC",-1),W={class:"text-subtitle2 center"},k={class:"col-12 col-md-3",style:{padding:"5px"}},O=(0,l._)("div",{class:"text-h6"},"Cancel Net",-1),z={class:"text-subtitle2 center"},E={class:"col-12 col-md-3",style:{padding:"5px"}},N=(0,l._)("div",{class:"text-h6"},"Less 90",-1),V={class:"text-subtitle2 center"},Z={class:"col-12 col-md-3",style:{padding:"5px"}},Q=(0,l._)("div",{class:"text-h6"},"90-120",-1),G={class:"text-subtitle2 center"},I={class:"col-12 col-md-3",style:{padding:"5px"}},$=(0,l._)("div",{class:"text-h6"},"120-180",-1),A={class:"text-subtitle2 center"},U=(0,l._)("div",{class:"col-12 col-md-3 desktop-only",style:{padding:"5px"}},null,-1),L={class:"col-12 col-md-3",style:{padding:"5px"}},j=(0,l._)("div",{class:"text-h6"},"180 Onwards",-1),F={class:"text-subtitle2 center"},Y={class:"col-12 col-md-3",style:{padding:"5px"}},B=(0,l._)("div",{class:"text-h6"},"Directly Closed",-1),H={class:"text-subtitle2 center"},M={class:"row",style:{"padding-top":"20px"}},K=(0,l._)("div",{class:"text-h6"},"Error",-1),J=(0,l.Uk)(" Start Date and End Date Required ");function X(e,t,s,X,ee,te){const se=(0,l.up)("q-input"),le=(0,l.up)("q-select"),ae=(0,l.up)("q-btn"),ie=(0,l.up)("q-card-section"),re=(0,l.up)("q-table"),oe=(0,l.up)("q-card-actions"),ce=(0,l.up)("q-card"),de=(0,l.up)("q-dialog"),ne=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",i,[(0,l._)("div",null,[(0,l._)("div",r,[o,(0,l._)("div",c,[(0,l._)("div",d,[n,(0,l.Uk)(" "+(0,a.zw)(this.todate),1)])])])]),m,(0,l._)("div",h,[(0,l._)("div",p,[(0,l.Wm)(se,{"bg-color":"white",outlined:"",type:"date",hint:"Start date *",modelValue:e.startDate,"onUpdate:modelValue":t[0]||(t[0]=t=>e.startDate=t),dense:"",style:{"max-width":"200px"}},null,8,["modelValue"])]),(0,l._)("div",u,[(0,l.Wm)(se,{"bg-color":"white",outlined:"",type:"date",hint:"End date *",min:e.minDate,max:e.maxDate,modelValue:e.endDate,"onUpdate:modelValue":t[1]||(t[1]=t=>e.endDate=t),dense:"",style:{"max-width":"200px"}},null,8,["min","max","modelValue"])]),(0,l._)("div",_,[(0,l.Wm)(le,{"bg-color":"white",outlined:"",options:e.promisedTime,modelValue:e.chosenPromised,"onUpdate:modelValue":t[2]||(t[2]=t=>e.chosenPromised=t),"option-label":"Promised Time",hint:"Promised Time",label:"Promised Time",dense:"",style:{"max-width":"200px"}},null,8,["options","modelValue"])]),(0,l._)("div",v,[(0,l.Wm)(ae,{color:"primary","icon-right":"search",label:"Search","no-caps":"",onClick:e.search,style:{"max-width":"150px"}},null,8,["onClick"])]),(0,l._)("div",x,[(0,l.Wm)(ae,{color:"primary","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:e.exportTable,style:{"max-width":"150px"}},null,8,["onClick"])])]),(0,l._)("div",g,[(0,l._)("div",y,[(0,l.Wm)(ie,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>[f,(0,l._)("div",w,(0,a.zw)(this.grossTotal),1)])),_:1})]),(0,l._)("div",b,[(0,l.Wm)(ie,{class:"bg-primary text-white col-3"},{default:(0,l.w5)((()=>[D,(0,l._)("div",P,(0,a.zw)(this.netTotal),1)])),_:1})]),(0,l._)("div",T,[(0,l.Wm)(ie,{class:"bg-primary text-white col-3"},{default:(0,l.w5)((()=>[S,(0,l._)("div",C,(0,a.zw)(this.avgCheck),1)])),_:1})]),(0,l._)("div",R,[(0,l.Wm)(ie,{class:"bg-primary text-white col-3"},{default:(0,l.w5)((()=>[q,(0,l._)("div",W,(0,a.zw)(this.cancelTC),1)])),_:1})]),(0,l._)("div",k,[(0,l.Wm)(ie,{class:"bg-primary text-white col-2"},{default:(0,l.w5)((()=>[O,(0,l._)("div",z,(0,a.zw)(this.cancelNet),1)])),_:1})]),(0,l._)("div",E,[(0,l.Wm)(ie,{class:"bg-primary text-white col-2"},{default:(0,l.w5)((()=>[N,(0,l._)("div",V,(0,a.zw)(this.less90),1)])),_:1})]),(0,l._)("div",Z,[(0,l.Wm)(ie,{class:"bg-primary text-white col-2"},{default:(0,l.w5)((()=>[Q,(0,l._)("div",G,(0,a.zw)(this.x90120),1)])),_:1})]),(0,l._)("div",I,[(0,l.Wm)(ie,{class:"bg-primary text-white col-2"},{default:(0,l.w5)((()=>[$,(0,l._)("div",A,(0,a.zw)(this.x120180),1)])),_:1})]),U,(0,l._)("div",L,[(0,l.Wm)(ie,{class:"bg-primary text-white col-2"},{default:(0,l.w5)((()=>[j,(0,l._)("div",F,(0,a.zw)(this.x180onwards),1)])),_:1})]),(0,l._)("div",Y,[(0,l.Wm)(ie,{class:"bg-primary text-white col-2"},{default:(0,l.w5)((()=>[B,(0,l._)("div",H,(0,a.zw)(this.directlyClosed),1)])),_:1})])]),(0,l._)("div",M,[(0,l.Wm)(re,{pagination:e.initialPagination,color:"primary",columns:e.columns,rows:this.deliveryReport.Orders,"row-key":"name",ref:"tb",loading:e.loading,class:"col-12"},null,8,["pagination","columns","rows","loading"])])]),(0,l.Wm)(de,{modelValue:e.persistent,"onUpdate:modelValue":t[3]||(t[3]=t=>e.persistent=t),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(ce,{class:"bg-red text-white",style:{width:"300px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(ie,null,{default:(0,l.w5)((()=>[K])),_:1}),(0,l.Wm)(ie,{class:"q-pt-none"},{default:(0,l.w5)((()=>[J])),_:1}),(0,l.Wm)(oe,{align:"right",class:"bg-white text-black"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(ae,{flat:"",label:"OK"},null,512),[[ne]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var ee=s(3617),te=s(2841),se=s(1959),le=new Date,ae=le.getFullYear()+"-"+(le.getMonth()+1)+"-"+le.getDate();function ie(e,t){let s=void 0!==t?t(e):e;return s=void 0===s||null===s?"":String(s),s=s.split('"').join('""'),`"${s}"`}const re=(0,l.aZ)({name:"DeliveryPerformance",data:()=>({startDate:"",endDate:"",minDate:"",maxDate:"",persistent:(0,se.iH)(!1),grossTotal:0,netTotal:0,avgCheck:0,cancelTC:0,cancelNet:0,less90:0,x90120:0,x120180:0,x180onwards:0,directlyClosed:0,chosenPromised:"",promisedTime:["All","90","120","180"],todate:ae,initialPagination:{sortBy:"desc",descending:!0,rowsPerPage:50},columns:[{name:"TC",required:!0,label:"ID",align:"left",field:e=>e.TC,format:e=>`${e}`,sortable:!0},{name:"Order Number",required:!0,label:"Order Number",align:"left",field:e=>e.order_number,format:e=>`${e}`,sortable:!0},{name:"OrderDate",required:!0,label:"OrderDate",align:"left",style:"width: 10px",field:e=>e.OrderDate,format:e=>`${e}`,sortable:!0},{name:"NetTotal",required:!0,label:"Net Total",align:"left",style:"width: 20px",field:e=>e.NetTotal,format:e=>`${e}`,sortable:!0},{name:"GrossTotal",required:!0,label:"Gross Total",align:"left",style:"width: 10px",field:e=>e.GrossTotal,format:e=>`${e}`,sortable:!0},{name:"Status",required:!0,label:"Status",align:"left",style:"width: 20px",field:e=>e.Status,format:e=>`${e}`,sortable:!0}]}),computed:{...(0,ee.Se)("DeliveryPerformance",{deliveryReport:"GET_DELIVERY_REPORT",loading:"GET_LOADING"}),...(0,ee.Se)("Auth",{user:"GET_PROFILE"})},methods:{...(0,ee.nv)("DeliveryPerformance",["getDeliveryPerformance","getSearchResult"]),async search(){null==this.startDate||""==this.startDate||null==this.endDate||""==this.endDate?this.persistent=!0:(null!=this.chosenPromised&&""!=this.chosenPromised||(this.chosenPromised="All"),await this.getSearchResult({store_id:this.user.store_id,startDate:this.startDate,endDate:this.endDate,prTime:this.chosenPromised}).then((()=>{this.deliveryReport.Orders.length>0?(this.grossTotal=this.deliveryReport.StorePerformance[0].gross_total,this.netTotal=this.deliveryReport.StorePerformance[0].net_total,this.avgCheck=this.deliveryReport.StorePerformance[0].avg_check,this.cancelTC=this.deliveryReport.StorePerformance[0].cancel_tc,this.cancelNet=this.deliveryReport.StorePerformance[0].cancel_basic_total,this.less90=this.deliveryReport.StorePerformance[0].less_then_90min,this.x90120=this.deliveryReport.StorePerformance[0].x90_to_120min,this.x120180=this.deliveryReport.StorePerformance[0].x120_to_180min,this.x180onwards=this.deliveryReport.StorePerformance[0].more_than_180min,this.directlyClosed=this.deliveryReport.StorePerformance[0].direct_closed):this.resetCards()})))},async exportTable(){var e=new Date;e.setDate(e.getDate());var t=e.toISOString().slice(0,10),s=this.user;let l=this.deliveryReport.Orders;var a=s.store_name+"/DeliveryPerformance/"+t;const i=[this.columns.map((e=>ie(e.label)))].concat(l.map((e=>this.columns.map((t=>ie("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format))).join(",")))).join("\r\n");(0,te.Z)(a+".csv",i,"text/csv")},resetCards(){this.grossTotal=0,this.netTotal=0,this.avgCheck=0,this.cancelTC=0,this.cancelNet=0,this.less90=0,this.x90120=0,this.x120180=0,this.x180onwards=0,this.directlyClosed=0}},watch:{startDate(){if(""==this.startDate)this.minDate="",this.maxDate="";else{this.minDate=this.startDate;var e=new Date(this.startDate);e.setDate(e.getDate()+31),this.maxDate=e.toISOString().slice(0,10)}}},async beforeMount(){var e=this.user;this.resetCards(),await this.getDeliveryPerformance(e).then((()=>{this.grossTotal=this.deliveryReport.StorePerformance[0].gross_total,this.netTotal=this.deliveryReport.StorePerformance[0].net_total,this.avgCheck=this.deliveryReport.StorePerformance[0].avg_check,this.cancelTC=this.deliveryReport.StorePerformance[0].cancel_tc,this.cancelNet=this.deliveryReport.StorePerformance[0].cancel_basic_total,this.less90=this.deliveryReport.StorePerformance[0].less_then_90min,this.x90120=this.deliveryReport.StorePerformance[0].x90_to_120min,this.x120180=this.deliveryReport.StorePerformance[0].x120_to_180min,this.x180onwards=this.deliveryReport.StorePerformance[0].more_than_180min,this.directlyClosed=this.deliveryReport.StorePerformance[0].direct_closed}))}});var oe=s(4260),ce=s(4842),de=s(2448),ne=s(8240),me=s(5589),he=s(8107),pe=s(6778),ue=s(151),_e=s(9367),ve=s(677),xe=s(7518),ge=s.n(xe);const ye=(0,oe.Z)(re,[["render",X]]),fe=ye;ge()(re,"components",{QInput:ce.Z,QSelect:de.Z,QBtn:ne.Z,QCardSection:me.Z,QTable:he.Z,QDialog:pe.Z,QCard:ue.Z,QCardActions:_e.Z}),ge()(re,"directives",{ClosePopup:ve.Z})}}]);
"use strict";(globalThis["webpackChunkofs_2_0"]=globalThis["webpackChunkofs_2_0"]||[]).push([[577],{577:(t,e,o)=>{o.r(e),o.d(e,{default:()=>A});var s=o(3673),i=o(2323);const a={style:{overflow:"auto","max-height":"90vh","min-height":"90vh"}},l={class:"q-pa-md row",style:{"margin-left":"15px","margin-right":"15px","padding-left":"0px","border-bottom":"2px solid #DEDEDE"}},n=(0,s._)("div",{class:"col-6"},[(0,s._)("div",{style:{"font-size":"20px"}},[(0,s._)("b",null,"Product Mix")])],-1),r={class:"col-6"},c={style:{"font-size":"15px","text-align":"right"}},d=(0,s._)("b",null,"Date: ",-1),u=(0,s._)("div",{style:{"margin-left":"15px","margin-top":"15px","font-size":"15px"}},[(0,s._)("b",null,"Filters:")],-1),h={class:"items-start q-pa-md row"},p={class:"col-sm-2 col-xs-6 q-pa-sm"},m={class:"col-sm-2 col-xs-6 q-pa-sm"},g={class:"col-sm-2 col-xs-6 q-pa-sm"},x={class:"col-sm-2 col-xs-6 q-pa-sm"},_={class:"col-sm-2 col-xs-6 q-pa-sm"},D={class:"col-sm-2 col-xs-6 q-pa-sm"},b={style:{"padding-top":"10px"}},w={class:"q-pa-md",style:{"padding-top":"20px"}};function v(t,e,o,v,f,y){const S=(0,s.up)("q-input"),P=(0,s.up)("q-select"),T=(0,s.up)("q-btn"),q=(0,s.up)("q-table");return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("div",null,[(0,s._)("div",l,[n,(0,s._)("div",r,[(0,s._)("div",c,[d,(0,s.Uk)(" "+(0,i.zw)(this.todate),1)])])])]),u,(0,s._)("div",h,[(0,s._)("div",p,[(0,s.Wm)(S,{"bg-color":"white",outlined:"",type:"date",hint:"Start date *",modelValue:t.startDate,"onUpdate:modelValue":e[0]||(e[0]=e=>t.startDate=e),dense:"",style:{"max-width":"200px"}},null,8,["modelValue"])]),(0,s._)("div",m,[(0,s.Wm)(S,{"bg-color":"white",outlined:"",type:"date",hint:"End date *",min:t.minDate,max:t.maxDate,modelValue:t.endDate,"onUpdate:modelValue":e[1]||(e[1]=e=>t.endDate=e),dense:"",style:{"max-width":"200px"}},null,8,["min","max","modelValue"])]),(0,s._)("div",g,[(0,s.Wm)(P,{"bg-color":"white",outlined:"",options:t.productOptions,"option-value":"pos_code",modelValue:t.chosenProduct,"onUpdate:modelValue":e[2]||(e[2]=e=>t.chosenProduct=e),"option-label":"name",hint:"Choose a product",label:"All Products",dense:"",style:{"max-width":"200px"}},null,8,["options","modelValue"])]),(0,s._)("div",x,[(0,s.Wm)(P,{"bg-color":"white",outlined:"",options:t.sourceOptions,"option-value":"id",modelValue:t.chosenSource,"onUpdate:modelValue":e[3]||(e[3]=e=>t.chosenSource=e),"option-label":"source_name",hint:"Choose a Source",label:"All Sources",dense:"",style:{"max-width":"200px"}},null,8,["options","modelValue"])]),(0,s._)("div",_,[(0,s.Wm)(P,{"bg-color":"white",outlined:"",options:t.sourceOptions,"option-value":"id",modelValue:t.chosenSource,"onUpdate:modelValue":e[4]||(e[4]=e=>t.chosenSource=e),"option-label":"source_name",hint:"Choose a Source",label:"All Sources",dense:"",style:{"max-width":"200px"}},null,8,["options","modelValue"])]),(0,s._)("div",D,[(0,s._)("div",null,[(0,s.Wm)(T,{color:"primary","icon-right":"search",label:"Search","no-caps":"",onClick:t.search,style:{"max-width":"150px"}},null,8,["onClick"])]),(0,s._)("div",b,[(0,s.Wm)(T,{color:"primary","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:t.exportTable,style:{"max-width":"150px"}},null,8,["onClick"])])])]),(0,s._)("div",w,[(0,s.Wm)(q,{title:"",rows:t.rows,columns:t.columns,"row-key":"name",pagination:t.pagination,loading:t.loading},null,8,["rows","columns","pagination","loading"])])])}var f=o(741),y=o(2841),S=o(1959),P=new Date,T=P.getFullYear()+"-"+(P.getMonth()+1)+"-"+P.getDate();function q(t,e){let o=void 0!==e?e(t):t;return o=void 0===o||null===o?"":String(o),o=o.split('"').join('""'),`"${o}"`}const C=(0,s.aZ)({name:"ProductMix",data:()=>({startDate:"",endDate:"",minDate:"",maxDate:"",persistent:(0,S.iH)(!1),rows:[],productOptions:[],sourceOptions:[],chosenProduct:"",chosenSource:"",chosenStart:"",chosenEnd:"",source:"",product:"",todate:T,initialPagination:{sortBy:"desc",descending:!0,rowsPerPage:50},pagination:{page:1,rowsPerPage:25},columns:[{name:"POSCODE",required:!0,label:"POSCODE",align:"left",field:t=>t.pos_code,format:t=>`${t}`,sortable:!0},{name:"Product",required:!0,label:"Product",align:"left",field:t=>t.name,format:t=>`${t}`,sortable:!0},{name:"Category",required:!0,label:"Category",align:"left",style:"width: 10px",field:t=>t.category,format:t=>`${t}`,sortable:!0},{name:"Quantity",required:!0,label:"Quantity",align:"left",style:"width: 20px",field:t=>t.quantity,format:t=>`${t}`,sortable:!0},{name:"UPT",required:!0,label:"UPT",align:"left",style:"width: 10px",field:t=>t.upt,format:t=>`${t}`,sortable:!0},{name:"NetTotal",required:!0,label:"Net Total",align:"left",style:"width: 20px",field:t=>t.net_total,format:t=>`${t}`,sortable:!0}]}),computed:{...(0,f.Se)("ProductMix",{productMixReport:"GET_PRODUCT_MIX",productlist:"GET_PRODUCT_LIST",sourceslist:"GET_SOURCES_LIST",loading:"GET_LOADING"}),...(0,f.Se)("Auth",{user:"GET_PROFILE"})},methods:{...(0,f.nv)("ProductMix",["getProductMix","getProductsList","getSourcesList","getSearchResult"]),async search(){console.log("pumasok"),""==this.startDate?this.chosenStart="ALL":this.chosenStart=this.startDate,""==this.endDate?this.chosenEnd="ALL":this.chosenEnd=this.endDate,""==this.chosenProduct?this.product="ALL":this.product=this.chosenProduct.pos_code,""==this.chosenSource?this.source="ALL":this.source=this.chosenSource.id,await this.getSearchResult({store_id:this.user.store_id,startDate:this.chosenStart,endDate:this.chosenEnd,source:this.source,product:this.product}).then((()=>{this.rows=this.productMixReport,this.startDate="",this.endDate=""}))},async exportTable(){var t=new Date;t.setDate(t.getDate());var e=t.toISOString().slice(0,10),o=this.user;let s=this.productMixReport;var i=o.store_name+"/ProductMix/"+e;const a=[this.columns.map((t=>q(t.label)))].concat(s.map((t=>this.columns.map((e=>q("function"===typeof e.field?e.field(t):t[void 0===e.field?e.name:e.field],e.format))).join(",")))).join("\r\n");(0,y.Z)(i+".csv",a,"text/csv")},resetCards(){this.grossTotal=0,this.netTotal=0,this.avgCheck=0,this.cancelTC=0,this.cancelNet=0,this.less90=0,this.x90120=0,this.x120180=0,this.x180onwards=0,this.directlyClosed=0}},watch:{startDate(){if(""==this.startDate)this.minDate="",this.maxDate="";else{this.minDate=this.startDate;var t=new Date(this.startDate);t.setDate(t.getDate()+31),this.maxDate=t.toISOString().slice(0,10)}}},async beforeMount(){await this.getProductMix({store_id:this.user.store_id}).then((()=>{this.rows=this.productMixReport})),await this.getProductsList({store_id:this.user.store_id}).then((()=>{this.productOptions=this.productlist})),await this.getSourcesList({store_id:this.user.store_id}).then((()=>{this.sourceOptions=this.sourceslist}))}});var E=o(4260),O=o(4842),L=o(2448),V=o(8240),M=o(8107),k=o(7518),U=o.n(k);const R=(0,E.Z)(C,[["render",v]]),A=R;U()(C,"components",{QInput:O.Z,QSelect:L.Z,QBtn:V.Z,QTable:M.Z})}}]);
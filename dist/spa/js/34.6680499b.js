"use strict";(self["webpackChunkofs_2_0"]=self["webpackChunkofs_2_0"]||[]).push([[34],{7034:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var l=a(3673),i=a(2323);const r={style:{overflow:"auto",height:"88vh"}},n={class:"q-pa-md row",style:{"margin-left":"15px","margin-right":"15px","padding-left":"0px","border-bottom":"2px solid #DEDEDE"}},s=(0,l._)("div",{class:"col-6"},[(0,l._)("div",{style:{"font-size":"20px"}},[(0,l._)("b",null,"Diverted Orders")])],-1),d={class:"col-6"},o={style:{"font-size":"15px","text-align":"right"}},c=(0,l._)("b",null,"Date: ",-1),m=(0,l._)("div",{style:{"margin-left":"15px","margin-top":"15px","font-size":"15px"}},[(0,l._)("b",null,"Filters:")],-1),u={class:"row items-start q-pa-md"},g={class:"col-lg-2 col-md-3 col-sm-4 col-xs-6 q-pa-sm"},p={class:"col-lg-2 col-md-3 col-sm-4 col-xs-6 q-pa-sm"},D={class:"col-lg-2 col-md-3 col-sm-4 col-xs-6 q-pa-sm"},h={class:"col-lg-2 col-md-3 col-sm-4 col-xs-6 q-pa-sm"},v={class:"q-pa-md"},_=(0,l._)("div",{class:"text-h6"},"Alert",-1),f=(0,l.Uk)(" Start date and End date are required. ");function b(e,t,a,b,w,x){const y=(0,l.up)("q-input"),O=(0,l.up)("q-btn"),q=(0,l.up)("q-table"),k=(0,l.up)("q-card-section"),S=(0,l.up)("q-card-actions"),E=(0,l.up)("q-card"),C=(0,l.up)("q-dialog"),W=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)("div",r,[(0,l._)("div",null,[(0,l._)("div",n,[s,(0,l._)("div",d,[(0,l._)("div",o,[c,(0,l.Uk)(" "+(0,i.zw)(this.todate),1)])])]),m,(0,l._)("div",u,[(0,l._)("div",g,[(0,l.Wm)(y,{"bg-color":"white",outlined:"",type:"date",hint:"Start date *",modelValue:e.startDate,"onUpdate:modelValue":t[0]||(t[0]=t=>e.startDate=t),dense:""},null,8,["modelValue"])]),(0,l._)("div",p,[(0,l.Wm)(y,{"bg-color":"white",outlined:"",type:"date",hint:"End date *",min:e.minDate,max:e.maxDate,modelValue:e.endDate,"onUpdate:modelValue":t[1]||(t[1]=t=>e.endDate=t),dense:""},null,8,["min","max","modelValue"])]),(0,l._)("div",D,[(0,l.Wm)(O,{style:{width:"100%"},color:"primary","icon-right":"search",label:"Search","no-caps":"",onClick:e.searchFilter},null,8,["onClick"])]),(0,l._)("div",h,[(0,l.Wm)(O,{style:{width:"100%"},color:"primary","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:e.exportFiltered},null,8,["onClick"])])]),(0,l._)("div",null,[(0,l._)("div",v,[(0,l.Wm)(q,{pagination:e.initialPagination,color:"primary",columns:e.columns,rows:e.divertedOrders,loading:e.loading,"row-key":"name",ref:"tb"},null,8,["pagination","columns","rows","loading"])])])]),(0,l.Wm)(C,{modelValue:e.dialog,"onUpdate:modelValue":t[2]||(t[2]=t=>e.dialog=t),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:(0,l.w5)((()=>[(0,l.Wm)(E,{class:"bg-red text-white",style:{width:"300px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[_])),_:1}),(0,l.Wm)(k,{class:"q-pt-none"},{default:(0,l.w5)((()=>[f])),_:1}),(0,l.Wm)(S,{align:"right",class:"bg-white text-black"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(O,{flat:"",label:"OK"},null,512),[[W]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var w=a(3617),x=a(2841);function y(e,t){let a=void 0!==t?t(e):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),`"${a}"`}var O=new Date,q=O.getFullYear()+"-"+(O.getMonth()+1)+"-"+O.getDate();const k=(0,l.aZ)({name:"Diverted Orders",computed:{...(0,w.Se)("DivertedOrder",{divertedOrders:"GET_DIVERTED_ORDERS",loading:"GET_LOADING"}),...(0,w.Se)("Auth",{user:"GET_PROFILE"})},data(){return{todate:q,initialPagination:{sortBy:"desc",descending:!0,rowsPerPage:50},columns:[{name:"order_number",label:"Order No",field:"order_number",align:"center"},{name:"order_date",label:"Order Date",field:"order_date",align:"center"},{name:"created_by",label:"Created By",field:"created_by",align:"center"},{name:"orig_store",label:"From",field:"orig_store",align:"center"},{name:"new_store",label:"To",field:"new_store",align:"center"},{name:"reason",label:"Reason",field:"reason",align:"center"},{name:"remarks",label:"Remarks",field:"remarks",align:"center"},{name:"diverted_by",label:"Diverted By",field:"diverted_by",align:"center"},{name:"diverted_date",label:"Divert Date",field:"diverted_date",align:"center"}],startDate:"",endDate:"",dialog:!1,position:"top",minDate:"",maxDate:""}},methods:{...(0,w.nv)("DivertedOrder",["getDivertedOrders"]),exportFiltered(){var e=new Date;e.setDate(e.getDate());var t=e.toISOString().slice(0,10),a=this.user,l=a.store_name+"/DivertedOrders/"+t;const i=[this.columns.map((e=>y(e.label)))].concat(this.$refs.tb.filteredSortedRows.map((e=>this.columns.map((t=>y("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format))).join(",")))).join("\r\n");(0,x.Z)(l+".csv",i,"text/csv")},searchFilter(){const e=new Date;e.getHours(),e.getMinutes(),e.getSeconds();""==this.startDate||""==this.endDate?(this.dialog=!0,this.rows=[]):this.getDivertedOrders({startDate:this.startDate,endDate:this.endDate})}},watch:{startDate(){if(""==this.startDate)this.minDate="",this.maxDate="";else{this.minDate=this.startDate;var e=new Date(this.startDate);e.setDate(e.getDate()+31),this.maxDate=e.toISOString().slice(0,10)}}}});var S=a(4260),E=a(4842),C=a(8240),W=a(8107),Z=a(6778),V=a(151),F=a(5589),Q=a(9367),R=a(677),I=a(7518),P=a.n(I);const T=(0,S.Z)(k,[["render",b]]),U=T;P()(k,"components",{QInput:E.Z,QBtn:C.Z,QTable:W.Z,QDialog:Z.Z,QCard:V.Z,QCardSection:F.Z,QCardActions:Q.Z}),P()(k,"directives",{ClosePopup:R.Z})}}]);
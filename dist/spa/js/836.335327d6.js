"use strict";(self["webpackChunkofs_2_0"]=self["webpackChunkofs_2_0"]||[]).push([[836],{3836:(e,a,l)=>{l.r(a),l.d(a,{default:()=>j});var t=l(3673),n=l(2323);const i={style:{overflow:"auto",height:"86vh"}},o={class:"q-pa-md row",style:{"margin-left":"15px","margin-right":"15px","padding-left":"0px","border-bottom":"2px solid #DEDEDE"}},s=(0,t._)("div",{class:"col-6"},[(0,t._)("div",{style:{"font-size":"20px"}},[(0,t._)("b",null,"Sales")])],-1),r={class:"col-6"},d={style:{"font-size":"15px","text-align":"right"}},c=(0,t._)("b",null,"Date: ",-1),m=(0,t._)("div",{style:{"margin-left":"15px","margin-top":"15px","font-size":"15px"}},[(0,t._)("b",null,"Filters:")],-1),u={class:"items-start q-pa-md row"},C={class:"col-sm-3 col-xs-6 q-pa-sm"},p={class:"col-sm-3 col-xs-6 q-pa-sm"},g={class:"col-sm-3 col-xs-6 q-pa-sm"},h={class:"col-sm-3 col-xs-6 q-pa-sm"},D={class:"col-sm-3 col-xs-6 q-pa-sm"},f={class:"col-sm-3 col-xs-6 q-pa-sm"},T={class:"col-sm-3 col-xs-6 q-pa-sm"},S={class:"col-sm-3 col-xs-6 q-pa-sm"},b={class:"q-pa-md"},y=(0,t._)("div",null,[(0,t._)("div",{class:"text-weight-bold",style:{color:"red"}},"Alert!"),(0,t._)("div",{class:"text-grey"},"Start date & End date are required.")],-1);function _(e,a,l,_,v,P){const w=(0,t.up)("q-select"),k=(0,t.up)("q-input"),x=(0,t.up)("q-btn"),V=(0,t.up)("q-table"),W=(0,t.up)("q-card-section"),A=(0,t.up)("q-card"),q=(0,t.up)("q-dialog");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t._)("div",null,[(0,t._)("div",o,[s,(0,t._)("div",r,[(0,t._)("div",d,[c,(0,t.Uk)(" "+(0,n.zw)(this.todate),1)])])]),m,(0,t._)("div",u,[(0,t._)("div",C,[(0,t.Wm)(w,{"bg-color":"white",outlined:"",options:e.sourcesOption,modelValue:e.source,"onUpdate:modelValue":a[0]||(a[0]=a=>e.source=a),"option-value":"id","option-label":"source_name",hint:"Source",label:"All order sources",dense:""},null,8,["options","modelValue"])]),(0,t._)("div",p,[(0,t.Wm)(w,{"bg-color":"white",outlined:"",options:e.paymentOption,modelValue:e.payment,"onUpdate:modelValue":a[1]||(a[1]=a=>e.payment=a),"option-value":"id","option-label":"payment_type",hint:"Payment",label:"All order sources",dense:""},null,8,["options","modelValue"])]),(0,t._)("div",g,[(0,t.Wm)(w,{"bg-color":"white",outlined:"",options:e.methodOption,modelValue:e.method,"onUpdate:modelValue":a[2]||(a[2]=a=>e.method=a),"option-value":"id","option-label":"name",hint:"Method",label:"All order sources",dense:""},null,8,["options","modelValue"])]),(0,t._)("div",h,[(0,t.Wm)(w,{"bg-color":"white",outlined:"",options:["Daily","Hourly"],modelValue:e.groupBy,"onUpdate:modelValue":[a[3]||(a[3]=a=>e.groupBy=a),a[4]||(a[4]=a=>e.reset())],"option-value":"id","option-label":"name",hint:"Group By",label:"Group By",dense:""},null,8,["modelValue"])]),(0,t._)("div",D,[(0,t.Wm)(k,{"bg-color":"white",outlined:"",type:"date",hint:"Start date *",modelValue:e.startDate,"onUpdate:modelValue":a[5]||(a[5]=a=>e.startDate=a),dense:""},null,8,["modelValue"])]),(0,t._)("div",f,[(0,t.Wm)(k,{"bg-color":"white",outlined:"",type:"date",hint:"End date *",min:e.minDate,max:e.maxDate,modelValue:e.endDate,"onUpdate:modelValue":a[6]||(a[6]=a=>e.endDate=a),dense:""},null,8,["min","max","modelValue"])]),(0,t._)("div",T,[(0,t.Wm)(x,{style:{width:"100%"},color:"primary","icon-right":"search",label:"Search","no-caps":"",onClick:e.searchFilter},null,8,["onClick"])]),(0,t._)("div",S,[(0,t.Wm)(x,{style:{width:"100%"},color:"primary","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:e.exportFiltered},null,8,["onClick"])])]),(0,t._)("div",null,[(0,t._)("div",b,["Daily"==e.groupBy?((0,t.wg)(),(0,t.j4)(V,{key:0,id:"test",pagination:e.initialPagination,color:"primary",columns:e.columns,rows:e.sales,"row-key":"name",ref:"tb",loading:e.loading},null,8,["pagination","columns","rows","loading"])):(0,t.kq)("",!0),"Hourly"==e.groupBy?((0,t.wg)(),(0,t.j4)(V,{key:1,id:"test",pagination:e.initialPagination,color:"primary",columns:e.hourlyColumns,rows:e.sales,"row-key":"name",ref:"tb"},null,8,["pagination","columns","rows"])):(0,t.kq)("",!0)])])]),(0,t.Wm)(q,{modelValue:e.dialog,"onUpdate:modelValue":a[7]||(a[7]=a=>e.dialog=a),position:e.position},{default:(0,t.w5)((()=>[(0,t.Wm)(A,{style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{class:"row items-center no-wrap"},{default:(0,t.w5)((()=>[y])),_:1})])),_:1})])),_:1},8,["modelValue","position"])])}var v=l(3617),P=l(2841);function w(e,a){let l=void 0!==a?a(e):e;return l=void 0===l||null===l?"":String(l),l=l.split('"').join('""'),`"${l}"`}var k=new Date,x=k.getFullYear()+"-"+(k.getMonth()+1)+"-"+k.getDate();const V=(0,t.aZ)({name:"Sales",async beforeMount(){await this.allSources()},computed:{...(0,v.Se)("Sales",{sales:"GET_SALES",sources:"GET_SOURCES",loading:"GET_LOADING"}),...(0,v.Se)("Auth",{user:"GET_PROFILE"}),sourcesOption(){var e=this.sources;return e.sources},paymentOption(){var e=this.sources;return e.payment},methodOption(){var e=this.sources;return e.method}},data(){return{todate:x,initialPagination:{sortBy:"desc",descending:!0,rowsPerPage:50},columns:[{name:"DateDay",label:"Day",field:"DateDay",align:"center"},{name:"CashTC",label:"Cash TC",field:"CashTC",align:"center"},{name:"VouchersTC",label:"Vouchers TC",field:"VouchersTC",align:"center"},{name:"CreditCardTC",label:"Paymaya TC",field:"CreditCardTC",align:"center"},{name:"GcashTC",label:"Gcash TC",field:"GcashTC",align:"center"},{name:"BankTransferTC",label:"Bank Transfer TC",field:"BankTransferTC",align:"center"},{name:"CreditCardTC",label:"Credit Card TC",field:"CreditCardTC",align:"center"},{name:"AdvanceTC",label:"Advance Order",field:"AdvanceTC",align:"center"},{name:"SCDTC",label:"SCD TC",field:"SCDTC",align:"center"},{name:"PWDTC",label:"PWD TC",field:"PWDTC",align:"center"},{name:"SCD_DISC",label:"SCD DISC.",field:"SCD_DISC",field:"SCD_DISC",align:"center"},{name:"PWD_DISC",label:"PWD DISC.",field:"PWD_DISC",align:"center"},{name:"Discount",label:"Discount",field:"Discount",align:"center"},{name:"PROMOTC",label:"Promo TC",field:"PROMOTC",align:"center"},{name:"PromoDiscount",label:"Promo Discount",field:"PromoDiscount",align:"center"},{name:"TC",label:"TC",field:"TC",align:"center"},{name:"PackagingSales",label:"Packaging Sale",field:"PackagingSales",align:"center"},{name:"NetSales",label:"Net Sale",field:"NetSales",align:"center"},{name:"Sales",label:"Gross Sale",field:"Sales",align:"center"},{name:"AC",label:"AC",field:"AC",align:"center"},{name:"DeliverySalesTC",label:"Delivery Sales TC",field:"DeliverySalesTC",align:"center"},{name:"PickupSalesTC",label:"Pickup Sales TC",field:"PickupSalesTC",align:"center"}],hourlyColumns:[{name:"hour",label:"Hour",field:"hour",align:"center"},{name:"CashTC",label:"Cash TC",field:"CashTC",align:"center"},{name:"VouchersTC",label:"Vouchers TC",field:"VouchersTC",align:"center"},{name:"CreditCardTC",label:"Paymaya TC",field:"CreditCardTC",align:"center"},{name:"GcashTC",label:"Gcash TC",field:"GcashTC",align:"center"},{name:"BankTransferTC",label:"Bank Transfer TC",field:"BankTransferTC",align:"center"},{name:"CreditCardTC",label:"Credit Card TC",field:"CreditCardTC",align:"center"},{name:"AdvanceTC",label:"Advance Order",field:"AdvanceTC",align:"center"},{name:"SCDTC",label:"SCD TC",field:"SCDTC",align:"center"},{name:"PWDTC",label:"PWD TC",field:"PWDTC",align:"center"},{name:"SCD_DISC",label:"SCD DISC.",field:"SCD_DISC",field:"SCD_DISC",align:"center"},{name:"PWD_DISC",label:"PWD DISC.",field:"PWD_DISC",align:"center"},{name:"Discount",label:"Discount",field:"Discount",align:"center"},{name:"PROMOTC",label:"Promo TC",field:"PROMOTC",align:"center"},{name:"PromoDiscount",label:"Promo Discount",field:"PromoDiscount",align:"center"},{name:"TC",label:"TC",field:"TC",align:"center"},{name:"PackagingSales",label:"Packaging Sale",field:"PackagingSales",align:"center"},{name:"NetSales",label:"Net Sale",field:"NetSales",align:"center"},{name:"Sales",label:"Gross Sale",field:"Sales",align:"center"},{name:"AC",label:"AC",field:"AC",align:"center"},{name:"DeliverySalesTC",label:"Delivery Sales TC",field:"DeliverySalesTC",align:"center"},{name:"PickupSalesTC",label:"Pickup Sales TC",field:"PickupSalesTC",align:"center"}],rows:[],total_net:"",total_gross:"",searchText:"",startDate:"",endDate:"",source:{source_name:"All"},payment:{payment_type:"All"},method:{name:"All"},dialog:!1,position:"top",minDate:"",maxDate:"",groupBy:"Daily"}},methods:{...(0,v.nv)("Sales",["getSales","allSources","reset"]),exportFiltered(){var e=new Date;e.setDate(e.getDate());var a=e.toISOString().slice(0,10),l=this.user,t=l.store_name+"/Sales/"+a,n=null;n="Daily"==this.groupBy?[this.columns.map((e=>w(e.label)))].concat(this.$refs.tb.filteredSortedRows.map((e=>this.columns.map((a=>w("function"===typeof a.field?a.field(e):e[void 0===a.field?a.name:a.field],a.format))).join(",")))).join("\r\n"):[this.hourlyColumns.map((e=>w(e.label)))].concat(this.$refs.tb.filteredSortedRows.map((e=>this.hourlyColumns.map((a=>w("function"===typeof a.field?a.field(e):e[void 0===a.field?a.name:a.field],a.format))).join(",")))).join("\r\n");(0,P.Z)(t+".csv",n,"text/csv")},async searchFilter(){console.log({startDate:this.startDate,endDate:this.endDate,source:this.source["source_name"],payment:this.payment["payment_type"],method:this.method["name"],report_group_by:"day"}),""==this.startDate||""==this.endDate?(this.dialog=!0,this.rows=[]):(await this.getSales({startDate:this.startDate,endDate:this.endDate,source:this.source["source_name"],payment:this.payment["payment_type"],method:this.method["name"],report_group_by:this.groupBy}),console.log(this.sales),this.rows=this.sales)}},watch:{startDate(){if(""==this.startDate)this.minDate="",this.maxDate="";else{this.minDate=this.startDate;var e=new Date(this.startDate);e.setDate(e.getDate()+31),this.maxDate=e.toISOString().slice(0,10)}}}});var W=l(4260),A=l(2448),q=l(4842),O=l(8240),I=l(8107),B=l(6778),G=l(151),E=l(5589),Z=l(7518),U=l.n(Z);const R=(0,W.Z)(V,[["render",_]]),j=R;U()(V,"components",{QSelect:A.Z,QInput:q.Z,QBtn:O.Z,QTable:I.Z,QDialog:B.Z,QCard:G.Z,QCardSection:E.Z})}}]);